---
title: "R maps using Donnees EVIAM 15 17"
author: "MG"
date: "6/16/2022"
output: html_document
---
```{r}
library(ggplot2)
library(dplyr)
library(readxl)
library(leaflet)
library(sf)
```

```{r}
setwd("C:/Users/Milind Gupta/Desktop/2022_DSPG_SAHEL/2022_DSPG_Sahel")
mydata <-read_excel("Données EVIAM 15 17 insécurite alimentaire.xlsx")
head(mydata)
```

```{r}
library(sf)
Niger_level2 <- st_read(
  "C:/Users/Milind Gupta/Desktop/dspg-sahel/Level 2_new/niger_admin2.shp")
ggplot() + 
  geom_sf(data = Niger_level2, size = 1, color = "black", fill = "cyan1") + 
  ggtitle("Niger_level2") + 
  coord_sf()
```


```{r}

#mydata$admin2name[mydata$admin2name==“wrong”] <- “right”
#mydata$departement_name[mydata$departement_name==“Aguie”] <- “Aguié”

#df$var <- gsub(‘wrong’, ‘right’, df$var)


mydata$departement_name <- sub("Aguie", "Aguié", mydata$departement_name)
mydata$departement_name <- sub("Bankilare", "Bankilaré", mydata$departement_name)
mydata$departement_name <- sub("Filingue", "Filingué", mydata$departement_name)
mydata$departement_name <- sub("Gotheye", "Gothèye", mydata$departement_name)
mydata$departement_name <- sub("Goure", "Gouré", mydata$departement_name)
mydata$departement_name <- sub("Guidan-Roumdji", "Guidan Roumdji", mydata$departement_name)
mydata$departement_name <- sub("Illela", "Illéla", mydata$departement_name)
mydata$departement_name <- sub("Kantche", "Kantché", mydata$departement_name)
mydata$departement_name <- sub("Maine-Soroa", "Maïné Soroa", mydata$departement_name)
mydata$departement_name <- sub("Tera", "Téra", mydata$departement_name)
#mydata$departement_name <- sub("Tibiri ?Doutchi?", "Tibiri", mydata$departement_name)
mydata$departement_name <- sub("Tibiri .Doutchi.", "Tibiri", mydata$departement_name)

mydata$departement_name <- sub("Tillaberi", "Tillabéri", mydata$departement_name)

```

```{r}
nigerShpMerged=merge(x=Niger_level2,y=mydata,by.x="admin2Name",by.y="departement_name",all=TRUE)
ggplot() + 
  geom_sf(data = nigerShpMerged, size = 1, color = "black", aes(fill=moderate_part_15)) + 
  ggtitle("Population at Moderate Risk of Food Insecurity in Niger - 2015") + scale_fill_viridis_c()+
  coord_sf()+
  labs(fill = "Percent of Population")+theme_classic()
```
```{r}
nigerShpMerged=merge(x=Niger_level2,y=mydata,by.x="admin2Name",by.y="departement_name",all=TRUE)
ggplot(data = nigerShpMerged) + 
  geom_sf(size = 1, color = "black", aes(fill=moderate_part_15)) + 
  geom_sf_label(aes(label = admin2Name))+
  ggtitle("nigerShpMerged") + scale_fill_viridis_c()+
  labs(caption="used Données EVIAM 15 17 insécurite alimentaire and admin2 Niger shape file")+
  coord_sf()
```

```{r}
nigerShpMerged=merge(x=Niger_level2,y=mydata,by.x="admin2Name",by.y="departement_name",all=TRUE)
ggplot() + 
  geom_sf(data = nigerShpMerged, size = 1, color = "black", aes(fill=moderate_part_17)) + 
  ggtitle("Population at Moderate Risk of Food Insecurity in Niger - 2017") + scale_fill_viridis_c()+
  coord_sf()+
  labs(fill = "Percent of Population")+theme_classic()
```


