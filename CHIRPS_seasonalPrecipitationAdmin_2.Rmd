---
title: "CHIRPS_seasonalPrecipitation"
author: "CHB"
date: '2022-06-23'
output: html_document
---

Packages
```{r}
library(dplyr)
library(moderndive)
library(readr)
library(tidyr)
library(tidyverse)
library(lubridate)
library(reshape2)
```

Read in Data
```{r}
pentadData <-read.csv("C:/Users/Catherine/OneDrive/Documents/2022_DSPG_Sahel/rainfall_ts_niger_allyears.csv")
```

Renaming the Columns
```{r}
for ( col in 1:ncol(pentadData)){
  colnames(pentadData)[col] <- sub("_precipitation", "", colnames(pentadData)[col])
}

for ( col in 1:ncol(pentadData)){
  colnames(pentadData)[col] <- sub("X", "", colnames(pentadData)[col])
}
head(pentadData)
```

Convert data from Wide to Long for years 1981 to 1994
```{r}
precipitationData <- pentadData %>%
  select(admin2Name, admin1Name,admin2Pcod, "19810101": "20220121")
precipitationDataLong <- gather(precipitationData, Date, Precipitation, "19810101":"20220121")
head(precipitationDataLong)
```

Convert Characters to Dates
```{r}
precipitationDataLong$Date <- ymd(precipitationDataLong$Date)
head(precipitationDataLong)
```

Convert Data to Year, Month, Day Columns
```{r}
Data <- precipitationDataLong %>%
  dplyr::mutate(year = lubridate::year(precipitationDataLong$Date), 
                month = lubridate::month(precipitationDataLong$Date), 
                day = lubridate::day(precipitationDataLong$Date))
```

Total Precipitation by Year Summary
```{r}
yearSum = Data %>% group_by(admin2Name, year) %>%
  summarize(yearTotal_precipitation = sum(Precipitation, na.rm = FALSE),
            yearMean_precipitation = mean(Precipitation, na.rm = FALSE),
            yearMedian_precipitation = median(Precipitation, na.rm = FALSE),
            yearStandardDeviation_precipitation = sd(Precipitation, na.rm = FALSE),
            yearZScore_precipitation = (yearMean_precipitation/yearStandardDeviation_precipitation),
            .groups = "drop")
view(yearSum)
```

Total Precipitation by Month Summary
```{r}
monthlySum = Data %>% group_by(admin2Name, year, month) %>%
  summarize(total_precipitation = sum(Precipitation, na.rm = FALSE),
            mean_precipitation = mean(Precipitation, na.rm = FALSE),
            median_precipitation = median(Precipitation, na.rm = FALSE),
            standardDeviation_precipitation = sd(Precipitation, na.rm = FALSE),
            zScore_precipitation = (mean_precipitation/standardDeviation_precipitation),
            .groups = "drop")
view(monthlySum)
```

Seasonal Precipitation Summary
```{r}
seasonalPrecipitation <- monthlySum %>% 
  filter(month >= 5 & month <= 10) %>% 
  select(-month) %>%
  group_by(admin2Name, year) %>% 
  summarize(Seasonal_Precipitation = sum(total_precipitation, na.rm = FALSE),
            mean_precipitation = mean(total_precipitation, na.rm = FALSE),
            median_precipitation = median(total_precipitation, na.rm = FALSE),
            standardDeviation_precipitation = sd(total_precipitation, na.rm = FALSE),
            zScore_precipitation = (mean_precipitation/standardDeviation_precipitation),)
  
view(seasonalPrecipitation)
```

1981 to 2010 Filtered
```{r}
periodData = Data %>% group_by(admin2Name) %>%
  filter(year >= "1981" & year <= "2010") %>% 
  summarize(Total_precipitation = sum(Precipitation, na.rm = FALSE),
            Mean_precipitation = mean(Precipitation, na.rm = FALSE),
            StandardDeviation_precipitation = sd(Precipitation, na.rm = FALSE),
            ZScore_precipitation = (Mean_precipitation/StandardDeviation_precipitation),
            .groups = "drop")
view(periodData)
```

